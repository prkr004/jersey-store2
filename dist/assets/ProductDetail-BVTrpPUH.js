import{a as P,b as j,r as l,d as A,e as E,f as I,h as W,i as $,g as x,j as s,m as B,M as u}from"./index-CwiwxR1t.js";import{c as q}from"./format-Dd0aQ-Sh.js";import{a as R}from"./useProducts-COTeWHJF.js";import{g as F}from"./pricing-C7HRZ8N_.js";function H(){const{id:d}=P(),n=d?j[d]:null,{product:a,loading:c}=R(d),i=a||n,e=l.useMemo(()=>i?{...i,price:F(i.id)}:null,[i]),[p,h]=l.useState((e==null?void 0:e.sizes[0])??""),[m,v]=l.useState(0),{add:N,replaceWithSingle:k}=A(),{user:y}=E(),{requireAuth:w}=I(),[z,f]=l.useState(!1),S=W(),{toggle:C,contains:M}=$();l.useEffect(()=>{e&&h(e.sizes[0]??"")},[e]);const r=l.useMemo(()=>{if(!e)return[];const t=x(e.sport||"Football");return e.images&&e.images.length?e.images:[t,t]},[e]),g=l.useMemo(()=>e?Object.values(j).filter(t=>t.sport===e.sport&&t.id!==e.id).slice(0,4):[],[e]);return c&&!e?s.jsx("div",{className:"container mx-auto px-4 py-16",children:"Loading..."}):e?s.jsxs("div",{className:"container mx-auto px-4 py-10",children:[s.jsxs("div",{className:"grid lg:grid-cols-2 gap-10",children:[s.jsxs("div",{children:[s.jsx("div",{className:"aspect-[4/3] rounded-2xl overflow-hidden border border-slate-200/60 dark:border-slate-800",children:s.jsx(B.img,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},src:r[m],alt:e.name,className:"w-full h-full object-cover",onError:({currentTarget:t})=>{t.onerror=null;const o=(m+1)%Math.max(r.length,1);t.src=r[o]??"https://images.unsplash.com/photo-1655089131279-8029e8a21ac6?auto=format&fit=crop&w=1200&q=60"}},m)}),s.jsx("div",{className:"mt-3 flex gap-3",children:r.map((t,o)=>s.jsx("button",{onClick:()=>v(o),className:`w-20 h-20 rounded-xl overflow-hidden border ${o===m?"border-brand-500":"border-slate-200/60 dark:border-slate-800"}`,children:s.jsx("img",{src:t,alt:`${e.name} ${o+1}`,className:"w-full h-full object-cover",onError:({currentTarget:b})=>{b.onerror=null,b.src=r[(o+1)%Math.max(r.length,1)]??"https://images.unsplash.com/photo-1655089131279-8029e8a21ac6?auto=format&fit=crop&w=1200&q=60"}})},o))})]}),s.jsxs("div",{children:[s.jsx("h1",{className:"font-display text-4xl",children:e.name}),s.jsxs("div",{className:"mt-2 text-slate-600 dark:text-slate-400",children:[e.team," • ",e.sport||"Sport"]}),s.jsx("div",{className:"mt-3 text-2xl font-semibold text-brand-600",children:q(e.price)}),s.jsx("p",{className:"mt-6 text-slate-700 dark:text-slate-300",children:e.description}),s.jsxs("div",{className:"mt-6",children:[s.jsx("label",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Size"}),s.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:e.sizes.map(t=>s.jsx("button",{onClick:()=>h(t),className:`px-4 py-2 rounded-xl border ${p===t?"border-brand-500 bg-brand-500/10 text-brand-700 dark:text-brand-300":"border-slate-200/60 dark:border-slate-800 hover:bg-slate-100 dark:hover:bg-slate-800"}`,children:t},t))})]}),s.jsxs("div",{className:"mt-6 flex flex-wrap items-center gap-3",children:[s.jsx(u,{onClick:()=>{N(e.id,p||e.sizes[0],1,{id:e.id,name:e.name,price:e.price,images:r,team:e.team,sport:e.sport||"Sport",sizes:e.sizes,description:e.description}),f(!0),setTimeout(()=>f(!1),3e3)},className:"px-6 py-3",children:z?"Added ✓":"Add to Cart"}),s.jsx(u,{variant:"primary",className:"px-6 py-3 bg-brand-600 hover:bg-brand-500",onClick:async()=>{!y&&!await w("buy-now")||(k(e.id,p||e.sizes[0],1,{id:e.id,name:e.name,price:e.price,images:r,team:e.team,sport:e.sport||"Sport",sizes:e.sizes,description:e.description}),S("/cart",{state:{checkout:!0}}))},children:"Buy Now"}),s.jsx(u,{variant:"outline",className:"px-6 py-3",onClick:()=>{C({id:e.id,name:e.name,price:e.price,images:r,team:e.team,sport:e.sport||"Football",sizes:e.sizes,description:e.description})},children:M(e.id)?"Wishlisted ✓":"Wishlist"})]})]})]}),g.length>0&&s.jsxs("div",{className:"mt-12",children:[s.jsx("h2",{className:"font-display text-2xl mb-4",children:"You Might Also Like"}),s.jsx("div",{className:"grid gap-6 grid-cols-1 sm:grid-cols-2 lg:grid-cols-4",children:g.map(t=>s.jsx(L,{...t},t.id))})]})]}):s.jsx("div",{className:"container mx-auto px-4 py-16",children:"Product not found."})}function L({id:d,name:n,images:a,sport:c}){return s.jsxs("a",{href:`/product/${d}`,className:"group block rounded-2xl overflow-hidden border border-slate-200/60 dark:border-slate-800",children:[s.jsx("div",{className:"aspect-[4/3] overflow-hidden",children:s.jsx("img",{src:(a==null?void 0:a[0])||x(c),alt:n,className:"w-full h-full object-cover transition-transform duration-300 group-hover:scale-105",onError:({currentTarget:i})=>{i.onerror=null,i.src=(a==null?void 0:a[1])??x(c)}})}),s.jsx("div",{className:"p-4 font-medium",children:n})]})}export{H as default};
