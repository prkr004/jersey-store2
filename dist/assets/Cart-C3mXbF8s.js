import{d as P,j as e,L as $,X as M,r as h,h as I,n as X,M as g,e as E,f as A,o as B}from"./index-CwiwxR1t.js";import{c as N,g as q}from"./format-Dd0aQ-Sh.js";import{U as O}from"./UPIPayment-Bxqsv7Rf.js";function z({id:s,size:r,qty:d,img:n,name:a,price:t}){const{update:o,remove:u}=P();return e.jsxs("div",{className:"flex gap-4",children:[e.jsx($,{to:`/product/${s}`,className:"w-24 h-24 rounded-xl overflow-hidden border border-slate-200/60 dark:border-slate-800",children:e.jsx("img",{src:n,alt:a,className:"w-full h-full object-cover",onError:({currentTarget:c})=>{c.onerror=null,c.src="https://images.unsplash.com/photo-1655089131279-8029e8a21ac6?auto=format&fit=crop&w=600&q=60"}})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx($,{to:`/product/${s}`,className:"font-medium hover:text-brand-600",children:a}),e.jsxs("div",{className:"text-sm text-slate-500 dark:text-slate-400",children:["Size: ",r]}),e.jsx("div",{className:"mt-1 font-semibold",children:N(t)})]}),e.jsx("button",{onClick:()=>u(s,r),className:"p-2 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800",children:e.jsx(M,{size:16})})]}),e.jsx("div",{className:"mt-2",children:e.jsx(D,{value:d,onChange:c=>o(s,r,c)})})]})]})}function D({value:s,onChange:r}){const a=()=>r(Math.max(1,s-1)),t=()=>r(Math.min(10,s+1));return e.jsxs("div",{className:"inline-flex items-center rounded-lg border border-slate-300 dark:border-slate-700 overflow-hidden",children:[e.jsx("button",{onClick:a,className:"px-3 py-1 text-sm hover:bg-slate-100 dark:hover:bg-slate-800","aria-label":"Decrease quantity",children:"−"}),e.jsx("input",{value:s,onChange:o=>{const u=Number(o.target.value.replace(/[^\d]/g,""));isNaN(u)||r(Math.max(1,Math.min(10,u)))},className:"w-10 text-center bg-transparent text-sm py-1 focus:outline-none",inputMode:"numeric","aria-label":"Quantity"}),e.jsx("button",{onClick:t,className:"px-3 py-1 text-sm hover:bg-slate-100 dark:hover:bg-slate-800","aria-label":"Increase quantity",children:"+"})]})}function T({total:s,items:r,onClose:d,onComplete:n}){const[a,t]=h.useState("intro"),[o,u]=h.useState(!1),[c,l]=h.useState({name:"",email:"",phone:"",address:"",city:"",postal:""}),[b,i]=h.useState("upi"),[j,m]=h.useState(!1),k=I(),{placeOrder:S}=X();function y(){a==="intro"?t("info"):a==="info"?t("review"):a==="review"&&t("payment")}function C(){a==="info"?t("intro"):a==="review"?t("info"):a==="payment"&&t("review")}return e.jsx("div",{className:"fixed inset-0 z-[999] flex items-start justify-center p-4 sm:p-8 bg-slate-950/50 backdrop-blur-sm overflow-y-auto",children:e.jsxs("div",{className:"relative w-full max-w-3xl bg-white dark:bg-slate-900 rounded-2xl shadow-2xl border border-slate-200/60 dark:border-slate-700 flex flex-col",children:[e.jsxs("header",{className:"p-5 border-b border-slate-200/60 dark:border-slate-700 flex items-center justify-between",children:[e.jsx("h2",{className:"font-display text-xl",children:"Checkout"}),e.jsx("button",{onClick:d,className:"text-slate-500 hover:text-slate-800 dark:hover:text-slate-200 text-sm",children:"Close"})]}),e.jsxs("div",{className:"px-5 pt-5 pb-6 overflow-y-auto max-h-[70vh]",children:[e.jsx(L,{step:a}),a==="intro"&&e.jsx(V,{accepted:o,onAccept:u,onContinue:()=>o&&y(),total:s}),a==="info"&&e.jsx(Y,{info:c,setInfo:l,onContinue:()=>y(),onBack:C}),a==="review"&&e.jsx(F,{items:r,total:s,onContinue:y,onBack:C,info:c}),a==="payment"&&e.jsx(R,{mode:b,setMode:i,total:s,onBack:C,onPaid:()=>{m(!0);const w=S({items:r,method:b==="upi"?"UPI":b==="card"?"CARD":b==="netbanking"?"NETBANKING":"WALLET",shipping:{name:c.name,email:c.email,address:c.address,city:c.city,postalCode:c.postal},paymentRef:q()});n();const x={id:w.id,items:w.items.map(v=>({name:v.name,qty:v.qty,price:v.price,size:v.size})),total:w.totals.total,eta:H()};k("/order/confirmation",{state:{status:"success",order:x}})}})]})]})})}function L({step:s}){const r=["intro","info","review","payment"],d={intro:"T&C",info:"Details",review:"Review",payment:"Payment"},n=r.indexOf(s);return e.jsx("div",{className:"flex items-center gap-2 mb-6",children:r.map((a,t)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-xs font-medium border ${t<=n?"bg-brand-500 text-white border-brand-500":"bg-slate-100 dark:bg-slate-800 text-slate-500 border-slate-300/70 dark:border-slate-700"}`,children:t+1}),e.jsx("span",{className:`hidden sm:inline text-xs font-medium ${t<=n?"text-brand-600 dark:text-brand-300":"text-slate-500"}`,children:d[a]}),t<r.length-1&&e.jsx("div",{className:`w-8 sm:w-16 h-0.5 ${t<n?"bg-brand-500":"bg-slate-300 dark:bg-slate-700"}`})]},a))})}function V({accepted:s,onAccept:r,onContinue:d,total:n}){return e.jsxs("div",{className:"space-y-5",children:[e.jsx("h3",{className:"font-semibold text-lg",children:"Terms & Conditions"}),e.jsxs("div",{className:"text-sm leading-relaxed text-slate-600 dark:text-slate-400 space-y-3",children:[e.jsx("p",{children:"By continuing you agree to our policies regarding shipping, returns, digital communications, and data processing compliant with applicable laws."}),e.jsxs("ul",{className:"list-disc pl-5 space-y-1",children:[e.jsx("li",{children:"Orders ship within 2–4 business days."}),e.jsx("li",{children:"Custom jerseys are final sale."}),e.jsx("li",{children:"Refunds processed within 5–7 days of receipt."})]}),e.jsxs("p",{children:["Total payable now: ",e.jsx("span",{className:"font-semibold text-brand-600",children:N(n)})]})]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[e.jsx("input",{type:"checkbox",checked:s,onChange:a=>r(a.target.checked)}),e.jsx("span",{children:"I accept the Terms & Conditions."})]}),e.jsx(g,{disabled:!s,onClick:d,className:"mt-2",children:"Continue"})]})}function Y({info:s,setInfo:r,onContinue:d,onBack:n}){const[a,t]=h.useState(!1);function o(m,k){r({...s,[m]:k})}const u=/.+@.+\..+/.test(s.email),c=!s.postal||s.postal.length>=4,l={};s.name||(l.name="Name is required"),s.email&&!u&&(l.email="Enter a valid email"),s.email||(l.email="Email is required"),s.address||(l.address="Address is required"),s.postal&&!c&&(l.postal="Postal code too short");const b=Object.keys(l).length>0,i=m=>a||s[m],j="w-full rounded-lg border bg-white dark:bg-slate-800/70 px-4 py-2 text-sm transition-colors focus:outline-none focus:ring-2 focus:ring-brand-500/50 dark:placeholder:text-slate-500";return e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"font-semibold text-lg",children:"Customer Details"}),a&&b&&e.jsxs("div",{className:"rounded-lg border border-red-500/30 bg-red-500/5 px-4 py-3 text-xs text-red-600 flex items-start gap-2",children:[e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"mt-0.5",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("path",{d:"M12 8v5"}),e.jsx("path",{d:"M12 16h.01"})]}),e.jsx("span",{children:"Fix the highlighted fields before continuing."})]}),e.jsxs("div",{className:"grid sm:grid-cols-2 gap-5",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-1 uppercase tracking-wide text-slate-500",children:"Full Name"}),e.jsx("input",{"aria-invalid":!!l.name,placeholder:"Full name",value:s.name,onChange:m=>o("name",m.target.value),className:`${j} ${l.name&&i("name")?"border-red-500 focus:ring-red-500/40":"border-slate-300/60 dark:border-slate-700"}`}),l.name&&i("name")&&e.jsx("p",{className:"mt-1 text-[11px] text-red-600",children:l.name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-1 uppercase tracking-wide text-slate-500",children:"Email"}),e.jsx("input",{"aria-invalid":!!l.email,placeholder:"Email",type:"email",value:s.email,onChange:m=>o("email",m.target.value),className:`${j} ${l.email&&i("email")?"border-red-500 focus:ring-red-500/40":"border-slate-300/60 dark:border-slate-700"}`}),l.email&&i("email")&&e.jsx("p",{className:"mt-1 text-[11px] text-red-600",children:l.email})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-1 uppercase tracking-wide text-slate-500",children:"Phone (Optional)"}),e.jsx("input",{placeholder:"Phone",value:s.phone,onChange:m=>o("phone",m.target.value),className:`${j} border-slate-300/60 dark:border-slate-700`}),l.phone&&i("phone")&&e.jsx("p",{className:"mt-1 text-[11px] text-red-600",children:l.phone})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-1 uppercase tracking-wide text-slate-500",children:"City"}),e.jsx("input",{placeholder:"City",value:s.city,onChange:m=>o("city",m.target.value),className:`${j} border-slate-300/60 dark:border-slate-700`})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-1 uppercase tracking-wide text-slate-500",children:"Postal Code"}),e.jsx("input",{"aria-invalid":!!l.postal,placeholder:"Postal Code",value:s.postal,onChange:m=>o("postal",m.target.value),className:`${j} ${l.postal&&i("postal")?"border-red-500 focus:ring-red-500/40":"border-slate-300/60 dark:border-slate-700"}`}),l.postal&&i("postal")&&e.jsx("p",{className:"mt-1 text-[11px] text-red-600",children:l.postal})]}),e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx("label",{className:"block text-xs font-medium mb-1 uppercase tracking-wide text-slate-500",children:"Address"}),e.jsx("textarea",{"aria-invalid":!!l.address,placeholder:"Address",value:s.address,onChange:m=>o("address",m.target.value),className:`${j} min-h-[90px] resize-y ${l.address&&i("address")?"border-red-500 focus:ring-red-500/40":"border-slate-300/60 dark:border-slate-700"}`}),l.address&&i("address")&&e.jsx("p",{className:"mt-1 text-[11px] text-red-600",children:l.address})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(g,{variant:"outline",onClick:n,children:"Back"}),e.jsx(g,{disabled:b,onClick:()=>{t(!0),b||d()},children:"Continue"})]})]})}function F({items:s,total:r,onContinue:d,onBack:n,info:a}){return e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"font-semibold text-lg",children:"Review Order"}),e.jsx("div",{className:"space-y-3 max-h-60 overflow-y-auto pr-1",children:s.map(t=>e.jsxs("div",{className:"flex justify-between text-sm border-b border-slate-200/60 dark:border-slate-700 pb-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:t.product.name}),e.jsxs("div",{className:"text-xs text-slate-500",children:["Size ",t.size," × ",t.qty]})]}),e.jsx("div",{className:"font-medium",children:N(t.product.price*t.qty)})]},`${t.id}-${t.size}`))}),e.jsxs("div",{className:"rounded-xl bg-slate-50 dark:bg-slate-800 p-4 space-y-1 text-xs",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Ship To:"})," ",a.name||"—",", ",a.address||"—"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Email:"})," ",a.email||"—"]})]}),e.jsxs("div",{className:"flex justify-between font-semibold text-sm pt-2 border-t border-slate-200/60 dark:border-slate-700",children:[e.jsx("span",{children:"Total"}),e.jsx("span",{children:N(r)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(g,{variant:"outline",onClick:n,children:"Back"}),e.jsx(g,{onClick:d,children:"Proceed to Payment"})]})]})}function R({mode:s,setMode:r,total:d,onBack:n,onPaid:a}){return e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"font-semibold text-lg",children:"Payment"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:["upi","card","netbanking","wallet"].map(t=>e.jsx("button",{onClick:()=>r(t),className:`px-4 py-2 rounded-full text-xs font-medium border transition ${s===t?"bg-brand-500 text-white border-brand-500":"border-slate-300 dark:border-slate-700 hover:bg-slate-100 dark:hover:bg-slate-800"}`,children:t.toUpperCase()},t))}),s==="upi"&&e.jsx(O,{amount:d,config:{payeeVPA:"merchant@upi",payeeName:"JerseyX Store",note:"Order Payment"},onSimulateSuccess:a}),s==="card"&&e.jsx(U,{amount:d,onPaid:a}),s==="netbanking"&&e.jsx(W,{amount:d,onPaid:a}),s==="wallet"&&e.jsx(K,{amount:d,onPaid:a}),e.jsx("div",{className:"flex justify-between pt-2 border-t border-slate-200/60 dark:border-slate-700",children:e.jsx(g,{variant:"outline",onClick:n,children:"Back"})})]})}function U({amount:s,onPaid:r}){const[d,n]=h.useState(""),[a,t]=h.useState(""),[o,u]=h.useState(""),[c,l]=h.useState(""),[b,i]=h.useState(!1),j="w-full rounded-lg border bg-white dark:bg-slate-800/70 px-4 py-2 text-sm transition-colors focus:outline-none focus:ring-2 focus:ring-brand-500/40";function m(p){return p.replace(/[^\d]/g,"").replace(/(.{4})/g,"$1 ").trim()}const k=a.replace(/\D/g,""),S=k.length>=13&&k.length<=19,y=/^(0[1-9]|1[0-2])\/(\d{2})$/.test(o),C=/^\d{3,4}$/.test(c),w=d.trim().length>2,x={};w||(x.holder="Name required"),S||(x.number="Card number 13–19 digits"),y||(x.exp="Format MM/YY"),C||(x.cvc="3–4 digits");const v=Object.keys(x).length>0,f=p=>b||(p==="holder"?d:p==="number"?a:p==="exp"?o:c);return e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"grid gap-5 sm:grid-cols-2",children:[e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx("label",{className:"block text-xs font-medium mb-1 uppercase tracking-wide text-slate-500",children:"Cardholder Name"}),e.jsx("input",{value:d,onChange:p=>n(p.target.value),"aria-invalid":!w,placeholder:"Name on card",className:`${j} ${x.holder&&f("holder")?"border-red-500 focus:ring-red-500/40":"border-slate-300/60 dark:border-slate-700"}`}),x.holder&&f("holder")&&e.jsx("p",{className:"mt-1 text-[11px] text-red-600",children:x.holder})]}),e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx("label",{className:"block text-xs font-medium mb-1 uppercase tracking-wide text-slate-500",children:"Card Number"}),e.jsx("input",{value:m(a),inputMode:"numeric",onChange:p=>t(p.target.value.replace(/[^\d]/g,"")),"aria-invalid":!S,placeholder:"XXXX XXXX XXXX XXXX",className:`${j} tracking-widest ${x.number&&f("number")?"border-red-500 focus:ring-red-500/40":"border-slate-300/60 dark:border-slate-700"}`}),x.number&&f("number")&&e.jsx("p",{className:"mt-1 text-[11px] text-red-600",children:x.number})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-1 uppercase tracking-wide text-slate-500",children:"Expiry (MM/YY)"}),e.jsx("input",{value:o,onChange:p=>u(p.target.value.toUpperCase()),"aria-invalid":!y,placeholder:"MM/YY",className:`${j} ${x.exp&&f("exp")?"border-red-500 focus:ring-red-500/40":"border-slate-300/60 dark:border-slate-700"}`}),x.exp&&f("exp")&&e.jsx("p",{className:"mt-1 text-[11px] text-red-600",children:x.exp})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-1 uppercase tracking-wide text-slate-500",children:"CVC"}),e.jsx("input",{value:c,onChange:p=>l(p.target.value.replace(/[^\d]/g,"")),"aria-invalid":!C,placeholder:"CVC",className:`${j} ${x.cvc&&f("cvc")?"border-red-500 focus:ring-red-500/40":"border-slate-300/60 dark:border-slate-700"}`}),x.cvc&&f("cvc")&&e.jsx("p",{className:"mt-1 text-[11px] text-red-600",children:x.cvc})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(g,{disabled:v,onClick:()=>{i(!0),v||r()},children:["Pay ",N(s)]})}),e.jsx("p",{className:"text-[11px] text-slate-500 leading-snug",children:"Demo only – card details are validated locally and never sent to a server."})]})}function W({amount:s,onPaid:r}){const d=["HDFC","ICICI","SBI","AXIS","KOTAK","YES","PNB","BOB"];return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3 text-xs",children:d.map(n=>e.jsx("button",{onClick:r,className:"rounded-lg border border-slate-200 dark:border-slate-700 py-3 px-2 hover:bg-brand-500/10 font-medium",children:n},n))}),e.jsx("p",{className:"text-[11px] text-slate-500 leading-snug",children:"Selecting a bank here simulates redirect + success."})]})}function K({amount:s,onPaid:r}){const d=["PhonePe","Paytm","Amazon Pay","Mobikwik"];return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex flex-wrap gap-2 text-xs",children:d.map(n=>e.jsx("button",{onClick:r,className:"rounded-full border border-slate-300 dark:border-slate-700 px-4 py-2 hover:bg-brand-500/10 font-medium",children:n},n))}),e.jsx("p",{className:"text-[11px] text-slate-500 leading-snug",children:"Wallet selection simulates an instant success."})]})}function H(){const s=new Date;return s.setDate(s.getDate()+5),s.toLocaleDateString("en-IN",{day:"numeric",month:"short"})}function Z(){const{detailed:s,total:r,clear:d}=P(),{user:n}=E(),{requireAuth:a}=A(),t=I(),[o,u]=h.useState(!1),c=B();h.useEffect(()=>{var i;(i=c.state)!=null&&i.checkout&&s.length&&(n?u(!0):t("/account/login",{state:{returnTo:"/cart",message:"Please sign in to complete your purchase"}}),window.history.replaceState({},document.title))},[c.state,s.length,n,t]);const l=s.length>0,b=async()=>{!n&&!await a("checkout")||u(!0)};return e.jsxs("div",{className:"container mx-auto px-4 py-10",children:[e.jsx("h1",{className:"font-display text-4xl",children:"Your Cart"}),l?e.jsxs("div",{className:"mt-6 grid lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[s.map(i=>e.jsx("div",{className:"rounded-2xl border border-slate-200/60 dark:border-slate-800 p-4",children:e.jsx(z,{id:i.id,size:i.size,qty:i.qty,img:i.product.images[0],name:i.product.name,price:i.product.price})},`${i.id}-${i.size}`)),e.jsx("div",{className:"flex justify-end",children:e.jsx(g,{variant:"outline",onClick:d,children:"Clear Cart"})})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-200/60 dark:border-slate-800 p-6 h-fit",children:[e.jsx("h2",{className:"font-semibold text-lg",children:"Order Summary"}),e.jsxs("div",{className:"mt-4 flex justify-between text-sm",children:[e.jsx("span",{children:"Subtotal"}),e.jsx("span",{children:N(r)})]}),e.jsxs("div",{className:"mt-1 flex justify-between text-sm",children:[e.jsx("span",{children:"Shipping"}),e.jsx("span",{children:"Free"})]}),e.jsxs("div",{className:"mt-3 border-t border-slate-200/60 dark:border-slate-800 pt-3 flex justify-between font-semibold",children:[e.jsx("span",{children:"Total"}),e.jsx("span",{children:N(r)})]}),e.jsx(g,{className:"w-full mt-4",onClick:b,children:n?"Checkout":"Sign In to Checkout"})]})]}):e.jsxs("div",{className:"mt-6 rounded-2xl border border-slate-200/60 dark:border-slate-800 p-8 text-center",children:[e.jsx("p",{children:"Your cart is empty."}),e.jsx($,{to:"/shop",children:e.jsx(g,{className:"mt-4",children:"Start Shopping"})})]}),o&&e.jsx(T,{total:r,items:s,onClose:()=>u(!1),onComplete:()=>{u(!1),d()}})]})}export{Z as default};
