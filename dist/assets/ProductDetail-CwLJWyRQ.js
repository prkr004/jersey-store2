import{r as l,j as e,M as g,a as I,b as E,d as B,e as F,f as U,h as W,i as J,g as M,m as O}from"./index-CEOidj1b.js";import{c as R}from"./format-Dd0aQ-Sh.js";import{a as Q}from"./useProducts-BOPP8-Fk.js";import{g as q}from"./pricing-C7HRZ8N_.js";function G({onClose:o,onSave:i,colors:t,initial:r}){const[n,s]=l.useState((r==null?void 0:r.name)||""),[j,w]=l.useState((r==null?void 0:r.number)||""),[m,C]=l.useState((r==null?void 0:r.font)||"block"),[x,v]=l.useState((r==null?void 0:r.color)||"#ffffff"),[f,S]=l.useState(!1),b=n.toUpperCase().slice(0,12),p=j.replace(/[^0-9]/g,"").slice(0,2),N=b.length>=1,k=p.length>=1,y=(t==null?void 0:t[0])||"#0ea5e9",c=(t==null?void 0:t[1])||"#111827",z=l.useMemo(()=>Y(y,c,{name:b,number:p,color:x,font:m}),[y,c,b,p,x,m]);function L(){S(!0),!(!N||!k)&&i({name:b,number:p,color:x,font:m})}return e.jsx("div",{className:"fixed inset-0 z-[1000] bg-slate-950/50 backdrop-blur-sm flex items-center justify-center p-4",role:"dialog","aria-modal":"true",children:e.jsxs("div",{className:"w-full max-w-2xl bg-white dark:bg-slate-900 rounded-2xl border border-slate-200/60 dark:border-slate-800 overflow-hidden shadow-2xl",children:[e.jsxs("header",{className:"p-4 border-b border-slate-200/60 dark:border-slate-800 flex items-center justify-between",children:[e.jsx("h3",{className:"font-semibold text-lg",children:"Customize Jersey"}),e.jsx("button",{onClick:o,className:"text-slate-500 hover:text-slate-800 dark:hover:text-slate-200 text-sm",children:"Close"})]}),e.jsxs("div",{className:"p-4 grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"aspect-[4/3] rounded-xl overflow-hidden border border-slate-200/60 dark:border-slate-800 bg-slate-50 dark:bg-slate-800 flex items-center justify-center",children:e.jsx("img",{src:z,alt:"Jersey preview",className:"w-full h-full object-contain"})}),e.jsxs("div",{className:"mt-3 flex gap-2 text-xs",children:[e.jsx($,{value:"#ffffff",current:x,onPick:v,label:"White"}),e.jsx($,{value:"#000000",current:x,onPick:v,label:"Black"}),e.jsx($,{value:c,current:x,onPick:v,label:"Accent"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-1 uppercase tracking-wide text-slate-500",children:"Name on Jersey"}),e.jsx("input",{value:n,onChange:d=>s(d.target.value),placeholder:"e.g., RAHUL",className:`w-full rounded-lg border bg-white dark:bg-slate-800/70 px-4 py-2 text-sm transition-colors focus:outline-none focus:ring-2 ${f&&!N?"border-red-500 focus:ring-red-500/40":"border-slate-300/60 dark:border-slate-700 focus:ring-brand-500/40"}`}),f&&!N&&e.jsx("p",{className:"mt-1 text-[11px] text-red-600",children:"Enter 1–12 letters."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-1 uppercase tracking-wide text-slate-500",children:"Number"}),e.jsx("input",{value:p,onChange:d=>w(d.target.value),inputMode:"numeric",placeholder:"e.g., 10",className:`w-full rounded-lg border bg-white dark:bg-slate-800/70 px-4 py-2 text-sm transition-colors focus:outline-none focus:ring-2 ${f&&!k?"border-red-500 focus:ring-red-500/40":"border-slate-300/60 dark:border-slate-700 focus:ring-brand-500/40"}`}),f&&!k&&e.jsx("p",{className:"mt-1 text-[11px] text-red-600",children:"Enter 1–2 digits."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-1 uppercase tracking-wide text-slate-500",children:"Font Style"}),e.jsx("div",{className:"flex gap-2",children:["block","classic"].map(d=>e.jsx("button",{onClick:()=>C(d),className:`px-3 py-1 rounded-full text-xs border ${m===d?"bg-brand-500 text-white border-brand-500":"border-slate-300 dark:border-slate-700 hover:bg-slate-100 dark:hover:bg-slate-800"}`,children:d.toUpperCase()},d))})]}),e.jsxs("div",{className:"pt-2 flex justify-end gap-2",children:[e.jsx(g,{variant:"outline",onClick:o,children:"Cancel"}),e.jsx(g,{onClick:L,children:"Save Customization"})]}),e.jsx("p",{className:"text-[11px] text-slate-500 leading-snug",children:"Your customization will be saved with this item and shown during checkout and in orders."})]})]})]})})}function $({value:o,current:i,onPick:t,label:r}){const n=o.toLowerCase()===i.toLowerCase();return e.jsxs("button",{onClick:()=>t(o),className:`flex items-center gap-2 px-2 py-1 rounded-lg border text-xs ${n?"border-brand-500":"border-slate-300 dark:border-slate-700"}`,children:[e.jsx("span",{className:"w-4 h-4 rounded-full border border-slate-300 dark:border-slate-700",style:{background:o}}),r]})}function Y(o,i,t){const r=t.font==="block"?"'Impact', system-ui, sans-serif":"'Segoe UI', system-ui, sans-serif",n=`<?xml version="1.0" encoding="UTF-8"?>
  <svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 300 360'>
    <defs>
      <linearGradient id='g1' x1='0' y1='0' x2='0' y2='1'>
        <stop offset='0%' stop-color='${o}'/>
        <stop offset='100%' stop-color='${o}CC'/>
      </linearGradient>
      <clipPath id='shirt'>
        <path d='M60 70 L110 40 L150 80 L190 40 L240 70 L220 120 L220 290 Q220 320 190 320 L110 320 Q80 320 80 290 L80 120 Z' />
      </clipPath>
    </defs>

    <rect width='100%' height='100%' fill='#f3f4f6'/>
    <g clip-path='url(#shirt)'>
      <rect x='40' y='30' width='220' height='300' fill='url(#g1)'/>
      <rect x='40' y='130' width='220' height='8' fill='${i}' opacity='0.9'/>
      <rect x='40' y='220' width='220' height='8' fill='${i}' opacity='0.9'/>
      <text x='150' y='120' text-anchor='middle' font-family=${JSON.stringify(r)} font-size='20' font-weight='700' fill='${t.color}' letter-spacing='2'>${t.name}</text>
      <text x='150' y='205' text-anchor='middle' font-family=${JSON.stringify(r)} font-size='88' font-weight='800' fill='${t.color}' opacity='0.9'>${t.number}</text>
    </g>
    <path d='M60 70 L110 40 L150 80 L190 40 L240 70 L220 120 L220 290 Q220 320 190 320 L110 320 Q80 320 80 290 L80 120 Z' fill='none' stroke='#111827' stroke-width='4' opacity='0.7'/>
  </svg>`;return`data:image/svg+xml;utf8,${encodeURIComponent(n)}`}function X(){const{id:o}=I(),i=o?E[o]:null,{product:t,loading:r}=Q(o),n=t||i,s=l.useMemo(()=>n?{...n,price:q(n.id)}:null,[n]),[j,w]=l.useState((s==null?void 0:s.sizes[0])??""),[m,C]=l.useState(0),{add:x,replaceWithSingle:v}=B(),{user:f}=F(),{requireAuth:S}=U(),[b,p]=l.useState(!1),N=W(),{toggle:k,contains:y}=J(),[c,z]=l.useState(null),[L,d]=l.useState(!1);l.useEffect(()=>{s&&w(s.sizes[0]??"")},[s]);const u=l.useMemo(()=>{if(!s)return[];const a=M(s.sport||"Football");return s.images&&s.images.length?s.images:[a,a]},[s]),P=l.useMemo(()=>s?Object.values(E).filter(a=>a.sport===s.sport&&a.id!==s.id).slice(0,4):[],[s]);return r&&!s?e.jsx("div",{className:"container mx-auto px-4 py-16",children:"Loading..."}):s?e.jsxs("div",{className:"container mx-auto px-4 py-10",children:[e.jsxs("div",{className:"grid lg:grid-cols-2 gap-10",children:[e.jsxs("div",{children:[e.jsx("div",{className:"aspect-[4/3] rounded-2xl overflow-hidden border border-slate-200/60 dark:border-slate-800",children:e.jsx(O.img,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},src:u[m],alt:s.name,className:"w-full h-full object-cover",onError:({currentTarget:a})=>{a.onerror=null;const h=(m+1)%Math.max(u.length,1);a.src=u[h]??"https://images.unsplash.com/photo-1655089131279-8029e8a21ac6?auto=format&fit=crop&w=1200&q=60"}},m)}),e.jsx("div",{className:"mt-3 flex gap-3",children:u.map((a,h)=>e.jsx("button",{onClick:()=>C(h),className:`w-20 h-20 rounded-xl overflow-hidden border ${h===m?"border-brand-500":"border-slate-200/60 dark:border-slate-800"}`,children:e.jsx("img",{src:a,alt:`${s.name} ${h+1}`,className:"w-full h-full object-cover",onError:({currentTarget:A})=>{A.onerror=null,A.src=u[(h+1)%Math.max(u.length,1)]??"https://images.unsplash.com/photo-1655089131279-8029e8a21ac6?auto=format&fit=crop&w=1200&q=60"}})},h))})]}),e.jsxs("div",{children:[e.jsx("h1",{className:"font-display text-4xl",children:s.name}),e.jsxs("div",{className:"mt-2 text-slate-600 dark:text-slate-400",children:[s.team," • ",s.sport||"Sport"]}),e.jsx("div",{className:"mt-3 text-2xl font-semibold text-brand-600",children:R(s.price)}),e.jsx("p",{className:"mt-6 text-slate-700 dark:text-slate-300",children:s.description}),e.jsxs("div",{className:"mt-6",children:[e.jsx("label",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Size"}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:s.sizes.map(a=>e.jsx("button",{onClick:()=>w(a),className:`px-4 py-2 rounded-xl border ${j===a?"border-brand-500 bg-brand-500/10 text-brand-700 dark:text-brand-300":"border-slate-200/60 dark:border-slate-800 hover:bg-slate-100 dark:hover:bg-slate-800"}`,children:a},a))}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsx(g,{variant:"outline",onClick:()=>d(!0),children:"Customize"}),c&&e.jsxs("span",{className:"text-xs px-2 py-1 rounded-full border border-slate-300 dark:border-slate-700 uppercase tracking-wide",children:[c.name," #",c.number," • ",c.font]})]})]}),e.jsxs("div",{className:"mt-6 flex flex-wrap items-center gap-3",children:[e.jsx(g,{onClick:()=>{x(s.id,j||s.sizes[0],1,{id:s.id,name:s.name,price:s.price,images:u,team:s.team,sport:s.sport||"Sport",sizes:s.sizes,description:s.description},c||void 0),p(!0),setTimeout(()=>p(!1),3e3)},className:"px-6 py-3",children:b?"Added ✓":"Add to Cart"}),e.jsx(g,{variant:"primary",className:"px-6 py-3 bg-brand-600 hover:bg-brand-500",onClick:async()=>{!f&&!await S("buy-now")||(v(s.id,j||s.sizes[0],1,{id:s.id,name:s.name,price:s.price,images:u,team:s.team,sport:s.sport||"Sport",sizes:s.sizes,description:s.description},c||void 0),N("/cart",{state:{checkout:!0}}))},children:"Buy Now"}),e.jsx(g,{variant:"outline",className:"px-6 py-3",onClick:()=>{k({id:s.id,name:s.name,price:s.price,images:u,team:s.team,sport:s.sport||"Football",sizes:s.sizes,description:s.description})},children:y(s.id)?"Wishlisted ✓":"Wishlist"})]})]})]}),P.length>0&&e.jsxs("div",{className:"mt-12",children:[e.jsx("h2",{className:"font-display text-2xl mb-4",children:"You Might Also Like"}),e.jsx("div",{className:"grid gap-6 grid-cols-1 sm:grid-cols-2 lg:grid-cols-4",children:P.map(a=>e.jsx(Z,{...a},a.id))})]}),L&&e.jsx(G,{onClose:()=>d(!1),onSave:a=>{z(a),d(!1)},colors:s.colors,initial:c||void 0})]}):e.jsx("div",{className:"container mx-auto px-4 py-16",children:"Product not found."})}function Z({id:o,name:i,images:t,sport:r}){return e.jsxs("a",{href:`/product/${o}`,className:"group block rounded-2xl overflow-hidden border border-slate-200/60 dark:border-slate-800",children:[e.jsx("div",{className:"aspect-[4/3] overflow-hidden",children:e.jsx("img",{src:(t==null?void 0:t[0])||M(r),alt:i,className:"w-full h-full object-cover transition-transform duration-300 group-hover:scale-105",onError:({currentTarget:n})=>{n.onerror=null,n.src=(t==null?void 0:t[1])??M(r)}})}),e.jsx("div",{className:"p-4 font-medium",children:i})]})}export{X as default};
